from typing import List

"""
================================================================================
ğŸ“˜ é¢˜ç›®:æœ€å¤§å®½åº¦å¡ (Maximum Width Ramp)
#### ğŸ”— é¢˜ç›®é“¾æ¥: https://leetcode.cn/problems/maximum-width-ramp/
================================================================================
éš¾åº¦ï¼šä¸­ç­‰
æ ‡ç­¾ï¼šæ ˆ, æ•°ç»„, å•è°ƒæ ˆ

ã€é¢˜ç›®æè¿°ã€‘
ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ Aï¼Œå¡æ˜¯å…ƒç»„ (i, j)ï¼Œå…¶ä¸­  i < j ä¸” A[i] <= A[j]ã€‚è¿™æ ·çš„å¡çš„å®½åº¦ä¸º j - iã€‚

æ‰¾å‡º A ä¸­çš„å¡çš„æœ€å¤§å®½åº¦ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å› 0 ã€‚

--------------------------------------------------------------------------------
ğŸŒŸ ç¤ºä¾‹ 1:
   è¾“å…¥ï¼š[6,0,8,2,1,5]
   è¾“å‡ºï¼š4
   è§£é‡Šï¼š
   æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (1, 5): A[1] = 0 ä¸” A[5] = 5.

ğŸŒŸ ç¤ºä¾‹ 2:
   è¾“å…¥ï¼š[9,8,1,0,1,9,4,0,4,1]
   è¾“å‡ºï¼š7
   è§£é‡Šï¼š
   æœ€å¤§å®½åº¦çš„å¡ä¸º (i, j) = (2, 9): A[2] = 1 ä¸” A[9] = 1.

--------------------------------------------------------------------------------
ğŸ“ æç¤º (Constraints):
   â€¢ 2 <= A.length <= 50000
   â€¢ 0 <= A[i] <= 50000
================================================================================
"""


class Solution:
    stack: list[int] = [0] * 50001  # é¢„åˆ†é…å•è°ƒæ ˆç©ºé—´(å­˜ä¸‹æ ‡)
    r: int = 0  # æ ˆé¡¶æŒ‡é’ˆ(è¡¨ç¤ºæ ˆå†…å…ƒç´ ä¸ªæ•°)

    def maxWidthRamp(self, nums: List[int]) -> int:
        # åˆå§‹åŒ–: ä»¤r=1, ç›¸å½“äº0ä½ç½®å·²å…¥æ ˆ
        self.stack[0] = 0
        self.r = 1
        n: int = len(nums)

        # ç¬¬ä¸€æ­¥: æ­£å‘éå†, æ„å»ºå•è°ƒé€’å‡æ ˆ
        for i in range(1, n):
            # åªæœ‰æ¯”æ ˆé¡¶å…ƒç´ æ›´å°, æ‰å…¥æ ˆ(ä½œä¸ºæ›´ä¼˜çš„å¡åº•)
            if nums[self.stack[self.r - 1]] > nums[i]:
                self.stack[self.r] = i  # ä¸‹æ ‡å…¥æ ˆ
                self.r += 1  # æ ˆæŒ‡é’ˆ+1

        ans: int = 0
        # ç¬¬äºŒæ­¥: ä»å³å¾€å·¦éå†, è´ªå¿ƒå¯»æ‰¾æœ€å¤§å®½åº¦
        for j in range(n - 1, -1, -1):
            # æ ˆä¸ä¸ºç©º ä¸” æ„æˆå¡(å½“å‰å€¼ >= æ ˆé¡¶å€¼)
            while self.r > 0 and nums[j] >= nums[self.stack[self.r - 1]]:
                ans = max(ans, j - self.stack[self.r - 1])  # æ›´æ–°æœ€å¤§å®½åº¦
                self.r -= 1  # æ ¸å¿ƒ: jåœ¨å‡å°, è¯¥å¡åº•å·²è¾¾æé™å®½åº¦, å¼¹å‡º
        return ans
