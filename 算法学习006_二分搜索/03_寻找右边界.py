"""
=================================================================================
ğŸ“˜ ç¨‹åºåç§°: äºŒåˆ†æŸ¥æ‰¾å¯¹æ•°å™¨ - å¯»æ‰¾å³è¾¹ç•Œ (Binary Search Validator - Find Rightmost)
=================================================================================
ã€ä¸»è¦åŠŸèƒ½ã€‘
éªŒè¯ "åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ <= num çš„æœ€å³ä½ç½®" ç®—æ³•çš„æ­£ç¡®æ€§.
é€šè¿‡å¤§é‡éšæœºæ ·æœ¬æµ‹è¯•, æ¯”å¯¹ "äºŒåˆ†æŸ¥æ‰¾" ä¸ "æš´åŠ›éå†" çš„ç»“æœ.

ã€æ ¸å¿ƒé€»è¾‘ã€‘
1. ç›®æ ‡ç®—æ³• (find_right): äºŒåˆ†æŸ¥æ‰¾ <= num çš„æœ€åä¸€ä¸ªä½ç½®.
   - ç­–ç•¥: é‡åˆ° <= num æ—¶, è®°å½•ç­”æ¡ˆå¹¶å‘å³æ‰©å±•èŒƒå›´, è¯•å›¾æ‰¾åˆ°æ›´é å³çš„ç­”æ¡ˆ.
2. éªŒè¯ç®—æ³• (right): é€†åºçº¿æ€§æ‰«æï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª <= num çš„ä½ç½®ä½œä¸ºæ ‡å‡†ç­”æ¡ˆ.
3. éšæœºæµ‹è¯• (test): ç”Ÿæˆéšæœºæ•°ç»„ -> æ’åº -> éšæœºæŸ¥æ‰¾ -> æ¯”å¯¹ç»“æœ.

ã€ä½¿ç”¨æ–¹æ³•ã€‘
ç›´æ¥è¿è¡Œ. å¦‚æœæ§åˆ¶å°ä»…æ‰“å° "Testing..." å’Œ "Test is complete", è¯´æ˜ç®—æ³•æ­£ç¡®.
=================================================================================
"""
from random import randint
from bisect import bisect_right


# bisect_rightå‡½æ•°
# def bisect_right(*args, **kwargs):  # çœŸå®ç­¾åæœªçŸ¥
#     """
#     è¿”å›å°†å…ƒç´  x æ’å…¥åˆ°åˆ—è¡¨ a ä¸­çš„ç´¢å¼•ä½ç½®,å‡è®¾ a å·²ç»æ˜¯æ’åºå¥½çš„.
#
#     è¿”å›å€¼ i æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:
#     - a[:i] (å³ i å·¦ä¾§) ä¸­çš„æ‰€æœ‰å…ƒç´  e éƒ½æ»¡è¶³ e <= x
#     - a[i:] (å³ i å³ä¾§) ä¸­çš„æ‰€æœ‰å…ƒç´  e éƒ½æ»¡è¶³ e > x
#
#     å› æ­¤,å¦‚æœ x å·²ç»å­˜åœ¨äºåˆ—è¡¨ä¸­,a.insert(i, x) ä¼šå°†æ–°å…ƒç´ æ’å…¥åˆ°
#     **å·²å­˜åœ¨çš„æœ€å³è¾¹çš„ x ä¹‹å**.
#
#     å¯é€‰å‚æ•° lo (é»˜è®¤ä¸º 0) å’Œ hi (é»˜è®¤ä¸º len(a)) ç”¨äºç•Œå®š
#     åˆ—è¡¨ a ä¸­éœ€è¦è¢«æœç´¢çš„åˆ‡ç‰‡èŒƒå›´.
#     """
#     pass

# ==========================================
# ğŸ¢ [æš´åŠ›æ–¹æ³•]
# ==========================================
def right(arr: list[int], num: int) -> int:
    n: int = len(arr)
    # ä»å³å¾€å·¦éå†
    for i in range(n - 1, -1, -1):
        # âš ï¸ ä¿®æ­£ç‚¹: æˆ‘ä»¬æ‰¾çš„æ˜¯ <= num, ä¸æ˜¯ >=
        if arr[i] <= num:
            return i
    return -1


# ==========================================
# âš¡ï¸ [å¾…æµ‹æ–¹æ³•] äºŒåˆ†æŸ¥æ‰¾ <= num çš„æœ€å³ä½ç½®
# ==========================================
def find_right(arr: list[int], num: int) -> int:
    l, r = 0, len(arr) - 1
    m: int = 0
    ans: int = -1
    while l <= r:
        m = l + ((r - l) >> 1)
        if arr[m] <= num:
            ans = m  # 1. æ»¡è¶³æ¡ä»¶(<=), è®°å½•ç­”æ¡ˆ
            l = m + 1  # 2. å¾€ã€å³ã€‘è¾¹ç»§ç»­æ‰¾
        else:
            r = m - 1  # 3. å¤ªå¤§äº†, å¾€å·¦è¾¹ç¼©
    return ans


# ==========================================
# ğŸ§ª [å¯¹æ•°å™¨] éªŒè¯é€»è¾‘
# ==========================================
def test(n: int, v: int):
    # 1. ç”Ÿæˆéšæœºæ•°ç»„
    arr: list[int] = [randint(1, v) for i in range(n)]

    # 2. âš ï¸ å¿…é¡»æ’åº
    arr.sort()

    # 3. ç”Ÿæˆéšæœºç›®æ ‡å€¼
    num: int = randint(0, v)

    if find_right(arr, num) != right(arr, num):
        print("Something went wrong.")


# ==========================================
# ğŸš€ ä¸»ç¨‹åº
# ==========================================
def main() -> None:
    N: int = 100  # å•æ¬¡æµ‹è¯•çš„æœ€å¤§æ•°ç»„é•¿åº¦
    V: int = 1000  # æ•°ç»„å…ƒç´ çš„æœ€å¤§æ•°å€¼
    testTime: int = 50000  # æµ‹è¯•æ€»æ¬¡æ•°

    print("Testing Binary Search (Find Right)...")

    for i in range(testTime):
        n: int = randint(1, N)
        test(n, V)

    print("Test is complete. âœ…")


if __name__ == '__main__':
    main()
