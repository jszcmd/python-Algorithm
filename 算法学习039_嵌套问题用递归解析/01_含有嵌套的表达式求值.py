""" å«æœ‰åµŒå¥—çš„è¡¨è¾¾å¼çš„æ±‚å€¼ """


# ç‰›å®¢æµ‹è¯•é“¾æ¥:https://www.nowcoder.com/practice/c215ba61c8b1443b996351df929dc4d4
# ä»£ç ä¸­çš„ç±»å(Solution),æ–¹æ³•å(solve),å‚æ•°åå·²ç»æŒ‡å®š,è¯·å‹¿ä¿®æ”¹,ç›´æ¥è¿”å›æ–¹æ³•è§„å®šçš„å€¼å³å¯
# ç›´æ¥æŠŠä¸‹é¢çš„Solutionç±»å¤åˆ¶åˆ°åŠ›æ‰£é‡Œé¢å°±å¯ä»¥è¿è¡Œ

class Solution:
    where: int = 0  # ğŸ§­ å…¨å±€æŒ‡é’ˆ:è®°å½•å½“å‰é€’å½’å¤„ç†åˆ°çš„å­—ç¬¦ä¸²ä½ç½®

    def solve(self, s: str) -> int:
        """
        ğŸ¯ ä¸»å…¥å£å‡½æ•°:è®¡ç®—å­—ç¬¦ä¸²è¡¨è¾¾å¼çš„å€¼
        ä½œç”¨:åˆå§‹åŒ–å…¨å±€æŒ‡é’ˆ,å¯åŠ¨é€’å½’è®¡ç®—è¿‡ç¨‹
        # è¿”å›è¡¨è¾¾å¼çš„å€¼
        # @param s stringå­—ç¬¦ä¸² å¾…è®¡ç®—çš„è¡¨è¾¾å¼
        # @return intæ•´å‹
        """
        self.where = 0  # ğŸ”„ é‡ç½®å…¨å±€æŒ‡é’ˆ
        return self.calc(s, 0)  # ğŸš€ ä»å­—ç¬¦ä¸²èµ·å§‹ä½ç½®å¼€å§‹è®¡ç®—

    def calc(self, s: str, i: int) -> int:
        """
        ğŸ”„ é€’å½’è®¡ç®—æ ¸å¿ƒå‡½æ•°
        ä½œç”¨:å¤„ç†æ•°å­—ã€è¿ç®—ç¬¦å’Œæ‹¬å·,è¿”å›å½“å‰è¡¨è¾¾å¼æ®µçš„ç»“æœ
        """
        cur: int = 0  # ğŸ”¢ å½“å‰ç´¯ç§¯çš„æ•°å­—å€¼
        number: list[int] = []  # ğŸ§® æ•°å­—æ ˆ:å­˜å‚¨å¾…è®¡ç®—çš„æ•°å­—
        ops: list[str] = []  # âš¡ æ“ä½œç¬¦æ ˆ:å­˜å‚¨å¾…æ‰§è¡Œçš„æ“ä½œç¬¦

        # ğŸ” éå†è¡¨è¾¾å¼,ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸæˆ–é‡åˆ°å³æ‹¬å·
        while i < len(s) and s[i] != ')':
            # 1ï¸âƒ£ é‡åˆ°æ•°å­—:æ„å»ºå¤šä½æ•°
            if '0' <= s[i] <= '9':
                cur = cur * 10 + int(s[i])  # ğŸ¯ æ„å»ºå¤šä½æ•°æ•°å­—
                i += 1

            # 2ï¸âƒ£ é‡åˆ°è¿ç®—ç¬¦:å‹å…¥æ ˆä¸­
            elif s[i] != '(':
                self.push(number, ops, cur, s[i])  # ğŸª å‹å…¥æ•°å­—å’Œè¿ç®—ç¬¦
                i += 1
                cur = 0  # ğŸ”„ é‡ç½®å½“å‰æ•°å­—

            # 3ï¸âƒ£ é‡åˆ°å·¦æ‹¬å·:é€’å½’è®¡ç®—æ‹¬å·å†…è¡¨è¾¾å¼
            else:
                cur = self.calc(s, i + 1)  # ğŸ”„ é€’å½’è®¡ç®—
                i = self.where + 1  # ğŸ§­ æ›´æ–°æŒ‡é’ˆ

        # ğŸ¯ å¤„ç†æœ€åä¸€ä¸ªæ•°å­—
        self.push(number, ops, cur, '+')
        self.where = i  # ğŸ“ æ›´æ–°å…¨å±€æŒ‡é’ˆ
        return self.compute(number, ops)  # ğŸ§® è¿”å›æœ€ç»ˆç»“æœ

    def push(self, number: list[int], ops: list[str], cur: int, op: str) -> None:
        """
        ğŸ“¥ å‹æ ˆå‡½æ•°
        ä½œç”¨:æ ¹æ®è¿ç®—ç¬¦ä¼˜å…ˆçº§å†³å®šç›´æ¥å‹æ ˆè¿˜æ˜¯å…ˆè®¡ç®—å†å‹æ ˆ
        """
        n: int = len(number)
        # ä½ä¼˜å…ˆçº§è¿ç®—ç¬¦:ç›´æ¥å‹æ ˆ
        if n == 0 or ops[n - 1] == '+' or ops[n - 1] == '-':
            number.append(cur)  # â• å‹å…¥æ•°å­—
            ops.append(op)  # â• å‹å…¥æ“ä½œç¬¦
        # é«˜ä¼˜å…ˆçº§è¿ç®—ç¬¦ï¼šå…ˆè®¡ç®—å†å‹æ ˆ
        else:
            topNumber: int = number.pop()  # ğŸ“¤ å¼¹å‡ºæ ˆé¡¶æ•°å­—
            topOper: str = ops.pop()  # ğŸ“¤ å¼¹å‡ºæ ˆé¡¶æ“ä½œç¬¦
            # ç«‹å³æ‰§è¡Œé«˜ä¼˜å…ˆçº§è¿ç®—
            if topOper == '*':
                number.append(topNumber * cur)  # âœ–ï¸ ä¹˜æ³•
            else:
                number.append(topNumber // cur)  # â— é™¤æ³•
            ops.append(op)  # â• å‹å…¥æ–°æ“ä½œç¬¦

    def compute(self, number: list[int], ops: list[str]) -> int:
        """
        ğŸ§® æœ€ç»ˆè®¡ç®—å‡½æ•°
        ä½œç”¨ï¼šå¤„ç†æ ˆä¸­å‰©ä½™çš„ä½ä¼˜å…ˆçº§åŠ å‡è¿ç®—ï¼Œè¿”å›æœ€ç»ˆç»“æœ
        """
        n: int = len(number)
        ans: int = number[0]  # ğŸ¯ åˆå§‹åŒ–ç»“æœ
        # å¤„ç†æ‰€æœ‰åŠ å‡è¿ç®—
        for i in range(1, n):
            ans += number[i] if ops[i - 1] == '+' else -number[i]  # â•â– åŠ å‡è¿ç®—
        return ans
