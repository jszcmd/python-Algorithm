import sys
# ğŸ“š å¼•å…¥ç¼“å­˜å·¥å…·,è¿™æ˜¯è®©é€’å½’å˜é£å¿«çš„å…³é”®!
from functools import lru_cache


class Solution:

    # ==========================================================================
    # ğŸ¢ æ–¹æ³•ä¸€:æš´åŠ›é€’å½’ (DFS)
    # --------------------------------------------------------------------------
    # åŸç†:æ¨¡æ‹Ÿæ¯ä¸€æ­¥çš„å°è¯•
    # ä¼˜åŒ–:ä½¿ç”¨äº† @lru_cache(None) å¼€å¯è®°å¿†åŒ–æœç´¢
    # ==========================================================================
    def winner_dfs(self, n: int) -> str:
        # æ¸…é™¤ä¹‹å‰çš„ç¼“å­˜,é˜²æ­¢å¹²æ‰°(å¯é€‰)
        self.dfs.cache_clear()
        return self.dfs(n, 'A')

    # @lru_cache(None) ä¼šè‡ªåŠ¨è®°å½•å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡º.
    # å¦‚æœä¸‹æ¬¡é‡åˆ°ç®—è¿‡çš„ rest,ç›´æ¥è¿”å›ç»“æœ,ä¸å†é‡å¤è®¡ç®—!
    # è¿™å°†æ—¶é—´å¤æ‚åº¦ä» æŒ‡æ•°çº§ é™åˆ°äº† O(n)
    @lru_cache(None)
    def dfs(self, rest: int, cur: str) -> str:
        # ğŸ‘¥ ç¡®å®šå¯¹æ‰‹æ˜¯è°
        enemy: str = 'B' if cur == 'A' else 'A'

        # ğŸ›‘ Base Case: å‰©ä½™è‰é‡å°äº 5
        # è§„åˆ™:0 å’Œ 2 æ˜¯æ­»å±€(å¿…è´¥),1, 3, 4 æ˜¯å¿…èƒœ
        if rest < 5:
            # å¦‚æœå‰© 0 æˆ– 2,å½“å‰é€‰æ‰‹ cur æ²¡æ³•æ“ä½œæˆ–è¢«è¿«è¾“æ‰ -> enemy èµ¢
            # å¦åˆ™ -> cur èµ¢
            return enemy if rest == 0 or rest == 2 else cur

        # ğŸ”„ Recursive Step: å°è¯•æ‰€æœ‰å¯èƒ½çš„åƒæ³• (1, 4, 16, 64...)
        pick: int = 1
        while pick <= rest:
            # æ ¸å¿ƒåšå¼ˆé€»è¾‘:
            # å¦‚æœæˆ‘æ‹¿èµ°äº† pick ä»½è‰,å‰©ä¸‹çš„å±€é¢å¯¹æ‰‹(enemy)å»ç©ï¼Œ
            # åªè¦æœ‰ä¸€ç§æƒ…å†µå¯¼è‡´"å¯¹æ‰‹è¾“äº†(ç»“æœè¿”å› cur)",é‚£æˆ‘è¿™æ­¥å°±èµ°å¯¹äº†,æˆ‘å¿…èƒœ!
            if self.dfs(rest - pick, enemy) == cur:
                return cur

            # ğŸ“ˆ å°è¯•ä¸‹ä¸€ç§åƒæ³•ï¼š4çš„å¹‚æ¬¡æ–¹
            pick *= 4

        # ğŸ˜­ å¦‚æœè¯•éäº†æ‰€æœ‰åƒæ³•,æ— è®ºæ€ä¹ˆèµ°,å¯¹æ‰‹éƒ½èƒ½èµ¢ -> é‚£æˆ‘è¾“äº†
        return enemy

    # ==========================================================================
    # ğŸ‡ æ–¹æ³•äºŒ:æ•°å­¦è§„å¾‹ (Math)
    # --------------------------------------------------------------------------
    # åŸç†:åˆ©ç”¨æ¨¡è¿ç®— O(1) ç›´æ¥åˆ¤æ–­
    # ==========================================================================
    def winner_math(self, n: int) -> str:
        # ğŸ“Š è§„å¾‹:
        # æ¨¡ 5 ä½™ 0, 2 -> åæ‰‹èµ¢ (B)
        # æ¨¡ 5 ä½™ 1, 3, 4 -> å…ˆæ‰‹èµ¢ (A)
        if n % 5 == 0 or n % 5 == 2:
            return 'B'
        else:
            return 'A'


if __name__ == '__main__':
    # å¢åŠ é€’å½’æ·±åº¦é™åˆ¶,é˜²æ­¢æ•°å­—å¤ªå¤§çˆ†æ ˆ
    sys.setrecursionlimit(20000)

    s = Solution()

    print("--------------------------------------------------")
    print("ğŸš€ å¼€å§‹æé€Ÿæµ‹è¯• (å¼€å¯äº†ç¼“å­˜é­”æ³•)")
    print("--------------------------------------------------")

    # ä¹‹å‰è·‘åˆ° 50 å°±å¡ä½,ç°åœ¨æˆ‘ä»¬å¯ä»¥è½»æ¾è·‘ 200 ç”šè‡³æ›´å¤šï¼
    for i in range(200):
        res_dfs = s.winner_dfs(i)
        res_math = s.winner_math(i)

        # éªŒè¯ä¸¤è€…ç»“æœæ˜¯å¦ä¸€è‡´
        is_same = (res_dfs == res_math)
        status = "âœ…" if is_same else "âŒ"

        # æ‰“å°å‰20ä¸ªè¯¦ç»†çœ‹,åé¢æ¯20ä¸ªæ‰“å°ä¸€æ¬¡è¿›åº¦
        if i < 20 or i % 20 == 0:
            print(f'ğŸŒ¿ {i:03d} ä»½è‰ | ğŸ† èµ¢å®¶: {res_dfs} | {status}')
